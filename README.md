# Map Party Assist 挖宝统计助手

用于记录藏宝图统计数据并协调宝图队伍的工具。

[![image](https://i.imgur.com/JeyAe7l.png) [![image](https://i.imgur.com/OMK8LPU.png)

[![Download count](https://img.shields.io/endpoint?url=https://qzysathwfhebdai6xgauhz4q7m0mzmrf.lambda-url.us-east-1.on.aws/MapPartyAssist)](https://github.com/wrath16/MapPartyAssist)

## 安装

1. 可在 Dalamud 主仓库中获取。

## 使用说明

### 地图追踪：

* 在聊天中输入 `/mparty` 打开追踪窗口。
* 当队员通过触碰宝箱或进入传送门来使用地图时，系统会自动为对应玩家打勾记录。
* 可通过右键点击每位队员的名字或勾选框来手动添加或移除地图。
* 若有人在队聊中链接集合点，其名字旁会出现放大镜图标，可悬停或点击以带着该集合点打开你自己的地图。
* 最近一次使用地图的队员会以黄色高亮显示。
* 地图会在 24 小时后自动归档，你仍可在此之前查看最近队员的地图；若一天内进行多场队伍，可手动清空记录。
* 在 `/mpartyconfig` 或 Dalamud 插件安装器中的“Settings”按钮可以打开配置菜单，提供地图与统计追踪相关的多种自定义选项。

### 宝物地城统计：

* 输入 `/mpartystats` 打开统计窗口。
* “Current” 过滤器只会统计当前主窗口所记录地图触发的副本。

### 注意事项：

* 仅支持国际客户端语言（EN/JP/FR/DE）。
* 插件主要依赖系统聊天信息进行解析，部分情况下无法准确判断地图持有者（已知情形列于下方），请留意并在必要时手动纠正。
* 使用 `/mpartyedit` 可在统计窗口中开启地图与副本记录的编辑模式，以便修正错误。
* 可通过导入功能补充插件不可用期间记录的统计数据。

## 已知问题

#### 地图追踪相关：

* 如果你与成功使用 Dig 的队员距离过远，追踪器无法判断宝箱拥有者，需要手动确认。
* 如果你与成功使用 Dig 的队员距离过远，但能接收到另一位队员失败使用 Dig 的信息，追踪器会认为后者是地图持有人，需要手动修正。
* 如果两名及以上队员几乎同时在可视范围内使用 Dig，追踪器会假定第一位使用 Dig 的玩家拥有出现的宝箱，但实际情况可能不同，需自行核对。
* 丢弃已开启的地图会生成与使用地图相同的系统信息，也会被记作已使用。
* 当某位队员在你进入传送门时离线，会取消传送门，并可能在盗贼地图（Thief's Map）的情况下造成重复计数。
* 若队员在刚结束他人常规地图且未进入传送门时立刻使用盗贼地图，可能不会被计入。
* 等待过久才进入非盗贼地图、且非自身地图的传送门，或在此期间重启游戏 / Dalamud，都可能导致重复计数。

#### 掉落追踪相关：

* 来自挑战日志的金币会被计入。
* 附近非藏宝图怪物掉落的物品也会被统计。
* 若聊天栏的显示名称设置不是“Full Name”，插件将无法正常工作。
